<?xml version="1.0" encoding="utf-8"?>
<odoo>

  <!-- VISTA FORMULARIO PARA PROJECT.TASK DESDE NUMERO DE SERVICIO - BAJA -->
  <record id="project_task_form_from_installed_services_uninstall" model="ir.ui.view"> 
    <field name="name">project.task.form.from.installed.services.uninstall</field> 
    <field name="model">project.task</field>
    <field name="arch" type="xml">
      <form string="Baja">
          <header>
            <field name="active" invisible="1"/>
            <field name="unbuild_task" invisible="1"/>
            <button name="authorize_unbuild" string="Aprobar Baja" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('active', '=', True), ('unbuild_task', '=', False)]}" groups="access_rights_assetel.proyecto_bajas_aprobacion"/>
            <button name="reject_unbuild" string="Rechazar Baja" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('active', '=', True), ('unbuild_task', '=', False)]}" groups="access_rights_assetel.proyecto_bajas_aprobacion"/>
            <field name="stage_id" widget="statusbar"/>
          </header>
          <sheet>
              <div class="badge-pill badge-warning float-right" attrs="{'invisible': ['|', ('unbuild_task', '=', False), ('active', '=', True)]}">Esperando aprobaci√≥n</div>
              <group>
                <div class="oe_title">
                  <h1>
                    <field name="name" placeholder="Nombre"/>
                  </h1>
                </div>
              </group>

              <group></group>

              <group>
                <group>
                  <field name="project_id" readonly="1"/>
                </group>
                <group>
                  <field name="partner_id" readonly="1"/>
                  <field name="user_ids" readonly="1"/>
                  <field name="requesting_user" invisible="1"/>
                </group>
              </group>
              <group>
                <field name="description"/>
              </group>
          </sheet>
          <div class="oe_chatter">
            <field name="message_follower_ids" widget="mail_followers"/>
            <field name="activity_ids" widget="mail_activity"/>
            <field name="message_ids" widget="mail_thread"/>
          </div>
      </form>
    </field> 
  </record>

  <record id="get_project_task_uninstall_view" model="ir.actions.act_window">
      <field name="name">Baja</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">project.task</field>
      <field name="view_mode">form</field>
      <field name="view_id" eval="project_task_form_from_installed_services_uninstall"/>
  </record>


  <record id="project_task_inherit_service_unbuild" model="ir.ui.view">
    <field name="name">project.task.inherit.service.unbuild</field>
    <field name="model">project.task</field>
    <field name="inherit_id" ref="project.view_task_form2"/>
    <field name="arch" type="xml">

        <xpath expr="//field[@name='stage_id']" position="before">
          <button name="authorize_unbuild" string="Aprobar Baja" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('active', '=', True), ('unbuild_task', '=', False)]}" groups="access_rights_assetel.proyecto_bajas_aprobacion"/>
          <button name="reject_unbuild" string="Rechazar Baja" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('active', '=', True), ('unbuild_task', '=', False)]}" groups="access_rights_assetel.proyecto_bajas_aprobacion"/>
          <field name="deactivate_service_stage" invisible="1"/>
          <field name="unbuild_task" invisible="1"/>
          <field name="unbuild_finished" invisible="1"/>
          <field name="requesting_user" invisible="1"/>
          <button name="new_service_unbuild" string="Desactivar Servicio" type="object" class="oe_highlight" attrs="{'invisible': ['|',('deactivate_service_stage', '=', False), ('unbuild_finished', '=', True)]}" groups="access_rights_assetel.proyecto_desactivar_servicio"/>
        </xpath>

        <xpath expr="//button[@name='new_service_unbuild']" position="attributes">
          <attribute name="effect">{"message":"Desactivado","fadeout":"medium"}</attribute>
        </xpath>

    </field>
  </record>


</odoo>
